// Default tasks
defaultTasks 'clean', 'build'

// Gradle initial setup
task wrapper(type: Wrapper) {
    gradleVersion = '1.9'
}

// Apply plugins
apply plugin: 'forge'
apply plugin: 'license'

// Repositories and dependencies to use
buildscript {
    repositories {
        mavenCentral()
        maven {
            name = "forge"
            url = "http://files.minecraftforge.net/maven"
        }
    }
    dependencies {
        classpath 'net.minecraftforge.gradle:ForgeGradle:1.0-SNAPSHOT'
        classpath 'nl.javadude.gradle.plugins:license-gradle-plugin:0.6.0'
    }
}

// Project information
group = "org.spoutcraft"
version = "1.0.0-SNAPSHOT"
archivesBaseName = "spoutcraftmod"
ext.packaging = 'jar'

// Minimum version of Java required
sourceCompatibility = "1.7"
targetCompatibility = "1.7"

// Minecraft Forge version
minecraft {
    version = "1.6.4-9.11.1.964"
}

// Dependencies needed for compilation and test
dependencies {
    compile 'io.netty:netty-all:4.0.13.Final'
    testCompile 'junit:junit:4.8.1'
}

// Include dependencies in the jar
jar {
    from {
        configurations.compile.collect {
            zipTree(it)
        }
    }
}

// License header formatting
import nl.javadude.gradle.plugins.license.License
tasks.withType(License).each { licenseTask ->
    licenseTask.exclude 'assets/**'
    licenseTask.exclude '**/*.info'
}
license {
    header rootProject.file('HEADER.txt')
    strictCheck true
    ext.name = 'SpoutcraftMod'
    ext.team = 'SpoutcraftDev'
    ext.website = 'http://spoutcraft.org'
    ext.inception = 2013
    ext.years = Calendar.getInstance().get(Calendar.YEAR) == ext.inception ? ext.inception : ext.inception + '-' + Calendar.getInstance().get(Calendar.YEAR)
}
licenseFormatMain.execute()

// Javadoc JAR generation
task javadocJar(type: Jar, dependsOn: javadoc) {
    classifier = 'javadoc'
    from 'build/docs/javadoc'
}

// Source JAR generation
task sourcesJar(type: Jar) {
    classifier = 'sources'
    from sourceSets.main.java.srcDirs
}

artifacts {
    archives jar, javadocJar, sourcesJar
}
